<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account - Success Chemistry</title>
    <meta name="description" content="Manage your account, view orders, track loyalty points, and manage subscriptions.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .topbar {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .topbar-inner {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .brand img {
            height: 50px;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: #0a234e;
            font-weight: 600;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #667eea;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .dashboard-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
        }

        .dashboard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .dashboard-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .sidebar {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .sidebar-nav {
            list-style: none;
        }

        .sidebar-nav li {
            margin-bottom: 5px;
        }

        .sidebar-nav a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            border-radius: 12px;
            text-decoration: none;
            color: #333;
            font-weight: 600;
            transition: all 0.3s;
        }

        .sidebar-nav a:hover,
        .sidebar-nav a.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .sidebar-nav .icon {
            font-size: 1.3rem;
        }

        .main-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            min-height: 600px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-title {
            font-size: 2rem;
            color: #0a234e;
            margin-bottom: 30px;
            font-weight: 700;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
            border: 2px solid #e9ecef;
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .stat-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: #0a234e;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: #666;
            font-weight: 600;
        }

        .order-list {
            margin-top: 30px;
        }

        .order-item {
            border: 2px solid #e9ecef;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .order-item:hover {
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.1);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .order-number {
            font-weight: 700;
            color: #0a234e;
            font-size: 1.1rem;
        }

        .order-status {
            padding: 6px 16px;
            border-radius: 999px;
            font-weight: 700;
            font-size: 0.85rem;
        }

        .order-status.completed {
            background: #d4edda;
            color: #155724;
        }

        .order-status.processing {
            background: #fff3cd;
            color: #856404;
        }

        .order-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .order-detail {
            font-size: 0.95rem;
        }

        .order-detail strong {
            display: block;
            color: #666;
            margin-bottom: 5px;
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            border-radius: 999px;
            text-decoration: none;
            font-weight: 700;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #e9ecef;
            color: #333;
        }

        .btn-secondary:hover {
            background: #dee2e6;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #0a234e;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .subscription-card {
            border: 2px solid #667eea;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea05, #764ba205);
        }

        .subscription-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .subscription-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #0a234e;
        }

        .subscription-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 6px 16px;
            border-radius: 999px;
            font-weight: 700;
            font-size: 0.85rem;
        }

        .subscription-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .subscription-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
            }

            .sidebar-nav {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 10px;
            }
        }

        @media (max-width: 768px) {
            .dashboard-header h1 {
                font-size: 2rem;
            }

            .main-content {
                padding: 25px;
            }

            .order-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="topbar">
        <div class="topbar-inner">
            <a class="brand" href="/">
                <img src="/public/images/SC_logo_withR.png" alt="Success Chemistry">
            </a>
            <div class="nav-links">
                <a href="/">Home</a>
                <a href="/blog">Articles</a>
                <a href="/shop">üß™ Shop</a>
                <a href="/cart">üõí Cart</a>
                <a href="/contact">Contact</a>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="container">
        <div class="dashboard-header">
            <h1>Welcome back, <span id="customerName">Customer</span>!</h1>
            <p>Manage your orders, loyalty points, subscriptions, and account settings</p>
        </div>

        <div class="dashboard-grid">
            <!-- Sidebar Navigation -->
            <div class="sidebar">
                <ul class="sidebar-nav">
                    <li><a href="#" class="nav-link active" data-section="overview"><span class="icon">üìä</span> Overview</a></li>
                    <li><a href="#" class="nav-link" data-section="loyalty"><span class="icon">‚≠ê</span> Loyalty Points</a></li>
                    <li><a href="#" class="nav-link" data-section="orders"><span class="icon">üì¶</span> Order History</a></li>
                    <li><a href="#" class="nav-link" data-section="subscriptions"><span class="icon">üîÑ</span> Subscriptions</a></li>
                    <li><a href="#" class="nav-link" data-section="settings"><span class="icon">‚öôÔ∏è</span> Account Settings</a></li>
                </ul>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Overview Section -->
                <div class="section active" id="overview">
                    <h2 class="section-title">Account Overview</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">‚≠ê</div>
                            <div class="stat-value" id="overviewPoints">0</div>
                            <div class="stat-label">Loyalty Points</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üì¶</div>
                            <div class="stat-value" id="overviewOrders">0</div>
                            <div class="stat-label">Total Orders</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üîÑ</div>
                            <div class="stat-value" id="overviewSubscriptions">0</div>
                            <div class="stat-label">Active Subscriptions</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üí∞</div>
                            <div class="stat-value" id="overviewSpent">$0</div>
                            <div class="stat-label">Total Spent</div>
                        </div>
                    </div>

                    <h3 style="margin-bottom: 20px; color: #0a234e;">Recent Orders</h3>
                    <div id="recentOrders"></div>
                </div>

                <!-- Loyalty Points Section -->
                <div class="section" id="loyalty">
                    <h2 class="section-title">‚≠ê Loyalty Rewards</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">‚≠ê</div>
                            <div class="stat-value" id="loyaltyPoints">0</div>
                            <div class="stat-label">Available Points</div>
                            <p style="margin-top: 10px; color: #667eea; font-weight: 700;" id="loyaltyValue">Worth $0.00</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üéâ</div>
                            <div class="stat-value" id="loyaltyEarned">0</div>
                            <div class="stat-label">Total Earned</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üéÅ</div>
                            <div class="stat-value" id="loyaltyRedeemed">0</div>
                            <div class="stat-label">Total Redeemed</div>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #667eea10, #764ba210); border-radius: 16px; padding: 30px; margin: 30px 0;">
                        <h3 style="color: #0a234e; margin-bottom: 15px;">How It Works</h3>
                        <p style="font-size: 1.1rem; margin-bottom: 15px;">Earn <strong>5 points for every $1</strong> you spend!</p>
                        <p style="color: #666;">Redeem 100 points for $1 off your next order. Minimum 500 points to redeem.</p>
                    </div>

                    <a href="/loyalty-dashboard.html" class="btn btn-primary">View Full Loyalty Dashboard ‚Üí</a>
                </div>

                <!-- Orders Section -->
                <div class="section" id="orders">
                    <h2 class="section-title">üì¶ Order History</h2>
                    <div class="order-list" id="ordersList"></div>
                </div>

                <!-- Subscriptions Section -->
                <div class="section" id="subscriptions">
                    <h2 class="section-title">üîÑ My Subscriptions</h2>
                    <div id="subscriptionsList"></div>
                </div>

                <!-- Settings Section -->
                <div class="section" id="settings">
                    <h2 class="section-title">‚öôÔ∏è Account Settings</h2>
                    
                    <form id="settingsForm">
                        <div class="form-group">
                            <label>Full Name</label>
                            <input type="text" id="fullName" placeholder="John Doe">
                        </div>
                        
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" id="email" placeholder="john@example.com">
                        </div>
                        
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" id="phone" placeholder="(555) 123-4567">
                        </div>
                        
                        <div class="form-group">
                            <label>Shipping Address</label>
                            <textarea id="address" rows="3" placeholder="123 Main St, City, State ZIP"></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/config.js"></script>
    <script src="/loyalty-points.js"></script>
    <script src="/tracking.js"></script>

    <script>
        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Update active nav
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                // Show section
                const sectionId = this.getAttribute('data-section');
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(sectionId).classList.add('active');
                
                // Load section data
                loadSectionData(sectionId);
            });
        });

        // Load section data
        function loadSectionData(section) {
            switch(section) {
                case 'overview':
                    loadOverview();
                    break;
                case 'loyalty':
                    loadLoyalty();
                    break;
                case 'orders':
                    loadOrders();
                    break;
                case 'subscriptions':
                    loadSubscriptions();
                    break;
                case 'settings':
                    loadSettings();
                    break;
            }
        }

        // Load overview
        function loadOverview() {
            const loyaltyData = window.LoyaltyPoints?.getData();
            const orders = getOrders();
            
            document.getElementById('overviewPoints').textContent = loyaltyData?.points.toLocaleString() || '0';
            document.getElementById('overviewOrders').textContent = orders.length;
            document.getElementById('overviewSubscriptions').textContent = '0'; // TODO: Implement subscriptions
            
            const totalSpent = orders.reduce((sum, order) => sum + (parseFloat(order.total) || 0), 0);
            document.getElementById('overviewSpent').textContent = '$' + totalSpent.toFixed(2);
            
            // Recent orders
            const recentContainer = document.getElementById('recentOrders');
            const recentOrders = orders.slice(0, 3);
            
            if (recentOrders.length === 0) {
                recentContainer.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì¶</div><h3>No orders yet</h3><p>Start shopping to see your orders here!</p><a href="/shop" class="btn btn-primary" style="margin-top: 20px;">Shop Now</a></div>';
            } else {
                recentContainer.innerHTML = recentOrders.map(order => createOrderHTML(order)).join('');
            }
        }

        // Load loyalty
        function loadLoyalty() {
            const data = window.LoyaltyPoints?.getData();
            if (!data) return;
            
            document.getElementById('loyaltyPoints').textContent = data.points.toLocaleString();
            document.getElementById('loyaltyEarned').textContent = data.totalEarned.toLocaleString();
            document.getElementById('loyaltyRedeemed').textContent = data.totalRedeemed.toLocaleString();
            
            const dollarValue = window.LoyaltyPoints.pointsToDollars(data.points);
            document.getElementById('loyaltyValue').textContent = `Worth $${dollarValue}`;
        }

        // Load orders
        function loadOrders() {
            const orders = getOrders();
            const container = document.getElementById('ordersList');
            
            if (orders.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì¶</div><h3>No orders yet</h3><p>Your order history will appear here once you make a purchase.</p><a href="/shop" class="btn btn-primary" style="margin-top: 20px;">Start Shopping</a></div>';
            } else {
                container.innerHTML = orders.map(order => createOrderHTML(order)).join('');
            }
        }

        // Create order HTML
        function createOrderHTML(order) {
            const date = new Date(order.date).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
            
            return `
                <div class="order-item">
                    <div class="order-header">
                        <div class="order-number">Order #${order.orderNumber}</div>
                        <div class="order-status ${order.status || 'completed'}">${(order.status || 'completed').toUpperCase()}</div>
                    </div>
                    <div class="order-details">
                        <div class="order-detail">
                            <strong>Date</strong>
                            ${date}
                        </div>
                        <div class="order-detail">
                            <strong>Total</strong>
                            $${parseFloat(order.total || 0).toFixed(2)}
                        </div>
                        <div class="order-detail">
                            <strong>Items</strong>
                            ${order.items?.length || 1} item(s)
                        </div>
                        <div class="order-detail">
                            <strong>Points Earned</strong>
                            ${order.pointsEarned || 0} pts
                        </div>
                    </div>
                </div>
            `;
        }

        // Load subscriptions
        function loadSubscriptions() {
            const container = document.getElementById('subscriptionsList');
            
            // TODO: Implement subscription loading from backend
            container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üîÑ</div><h3>No active subscriptions</h3><p>Subscribe to the Rainbow Subscription and get custom products every 2 months!</p><a href="/subscribe.html" class="btn btn-primary" style="margin-top: 20px;">View Subscription Options</a></div>';
        }

        // Load settings
        function loadSettings() {
            const settings = getSettings();
            
            document.getElementById('fullName').value = settings.name || '';
            document.getElementById('email').value = settings.email || '';
            document.getElementById('phone').value = settings.phone || '';
            document.getElementById('address').value = settings.address || '';
        }

        // Get orders from localStorage
        function getOrders() {
            const orders = localStorage.getItem('successChemistryOrders');
            return orders ? JSON.parse(orders) : [];
        }

        // Get settings from localStorage
        function getSettings() {
            const settings = localStorage.getItem('successChemistrySettings');
            return settings ? JSON.parse(settings) : {};
        }

        // Save settings
        document.getElementById('settingsForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const settings = {
                name: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value
            };
            
            localStorage.setItem('successChemistrySettings', JSON.stringify(settings));
            alert('‚úÖ Settings saved successfully!');
            
            // Update customer name in header
            document.getElementById('customerName').textContent = settings.name || 'Customer';
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadOverview();
            
            // Load customer name
            const settings = getSettings();
            if (settings.name) {
                document.getElementById('customerName').textContent = settings.name;
            }
        });
    </script>
</body>
</html>
